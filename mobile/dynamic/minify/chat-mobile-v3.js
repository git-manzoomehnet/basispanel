let userMessage=document.querySelectorAll(".YOU");userMessage.forEach((e=>{let t=e.querySelector(".message").innerHTML;e.querySelector(".CopyText").addEventListener("click",(()=>{console.log(t,"message"),copyToClipboard(t)}))}));let dropBtn=document.querySelector(".DropBTN"),dropBtnClose=document.querySelector(".DropPop .CloseDrop"),dropPop=document.querySelector(".DropPop");function copyToClipboard(e){const t=e;navigator.clipboard.writeText(t).then((()=>console.log("copy text"))).catch((e=>console.error("error in copy:",e)))}if(dropBtn.addEventListener("click",(()=>{dropPop.classList.add("OpenDrop")})),dropBtnClose.addEventListener("click",(()=>{dropPop.classList.remove("OpenDrop")})),document.querySelector(".UserProfile-box .User ")){let e=document.querySelector(".UserProfile-box .Icon "),t=document.querySelector(".UserProfile-box .UserDropdown"),o=document.querySelector(".logoOut ");document.querySelector(".UserProfile-box .User").addEventListener("click",(o=>{o.stopPropagation(),t.classList.toggle("openProf"),e.classList.toggle("openProf")})),o.addEventListener("click",(e=>{e.stopPropagation(),$bc.setSource("query.flag",!0),$bc.setSource("db.logout",!0)}))}function scrollToBottom(){const e=document.querySelector(".section-1 .container-chat .chats"),t=e.lastElementChild;t&&(t.scrollIntoView({behavior:"smooth"}),e.style.paddingBottom="100px")}let drops=document.querySelectorAll(".DropDowns .Drop");if(drops.forEach((e=>{let t=e.querySelector(".dropdown-menu"),o=e.querySelector(".title-dropdown"),n=e.querySelector(".icon");t&&t.querySelector("ul li")?o.addEventListener("click",(o=>{drops.forEach((t=>{if(t!==e){t.classList.remove("open");let e=t.querySelector(".dropdown-menu");e&&(e.style.height="0px",e.style.opacity="0")}})),e.classList.toggle("open"),e.classList.contains("open")?(t.style.height=t.scrollHeight+20+"px",t.style.opacity="1"):(t.style.height="0px",t.style.opacity="0")})):n&&(n.style.display="none")})),document.addEventListener("click",(e=>{if(document.querySelector(".UserProfile-box .User ")){let e=document.querySelector(".UserProfile-box .UserDropdown"),t=document.querySelector(".UserProfile-box .Icon ");e.classList.remove("openProf"),t.classList.remove("openProf")}})),document.querySelector(".Popup-container")){let n=document.querySelector(".Popup-container"),s=document.querySelector(".login-button"),c=document.querySelector(".Popup-container .ClosePop"),r=document.querySelector(".Popup-container");n.addEventListener("click",(e=>{e.target==r&&e.stopPropagation()}));function refreshAndFetch(){let e="http://nljpdiw.undertest.ir/dmntoken-v3.inc?nocache="+(new Date).getTime();fetch(e).then((e=>e.text())).then((e=>{let t=(new DOMParser).parseFromString(e,"text/html").querySelector(".dmntoken").textContent;$bc.setSource("db.token",t)})).catch((e=>console.error("خطا در دریافت مقدار:",e)))}s.addEventListener("click",(e=>{$bc.setSource("get.dmntoken",!0),n.classList.toggle("open"),refreshAndFetch(),$bc.setSource("run.token",!0)})),c.addEventListener("click",(e=>{n.classList.toggle("open"),$bc.setSource("run.api",!0),$bc.setSource("get.dmntoken",!1)}))}async function loadingchat(){document.querySelector("#chat");const e=document.createElement("div");e.setAttribute("class","YOU w-full flex gap-6 justify-start items-start"),e.innerHTML='\n   \n                <span class="userIcon w-[30px] h-[30px] flex justify-center items-center rounded-full">\n                    <img src="/images/user1-v3.png" alt="basis" title="basis" class="object-contain">\n                </span> \n                <div class="userDetail w-95p mr-auto grid grid-cols-[5fr,1fr] justify-start items-start " id="typewriter">\n                    <div class="  w-full flex justify-start font-IRANSansWeb400 font-normal text-[10px]\n                    leading-[30px] text-sm  current_section" id="current_section">\n                 <div class="typing-loader">\n    is typing <span></span><span></span><span></span>\n</div>\n                    </div>\n                    <div class="contact-c w-full flex justify-end items-center gap-2">\n                        <span class="CopyText hover:cursor-pointer" onclick="opcytext(this,event)">\n                            <img src="/images/copy-v3.svg" alt="basis" title="basis">\n                        </span>\n                        <span class="disLike hover:cursor-pointer">\n                            <img src="/images/dislike-v3.svg" alt="basis" title="basis">\n                        </span>\n                        <span class="like hover:cursor-pointer">\n                            <img src="/images/like-v3.svg" alt="basis" title="basis">\n                        </span>\n                    </div>\n                </div>\n            \n    ',document.querySelector("#chatbox").appendChild(e),scrollToBottom()}async function setChatFirst(e){const t=e.response,o=(await t.json()).message;document.querySelector(".typing-loader")&&(document.querySelector(".typing-loader").innerHTML="");for(var n=0;n<o.length;n++){let e=o;e=o.replace(/(?:Typing|\s*Typing\s*)/gi,""),typeText(e,n)}document.querySelector(".typing-loader").style.display="none"}function typeText(e,t){setTimeout((()=>{document.querySelector("#current_section").textContent+=e.charAt(t),scrollToBottom()}),50*t)}document.addEventListener("DOMContentLoaded",(()=>{const e=new Lenis;requestAnimationFrame((function t(o){e.raf(o),requestAnimationFrame(t)}))})),document.querySelector("header").classList.add("bgWhite");const detectLanguage=e=>{let t=document.querySelector("#chatbox");if(/[\u0600-\u06FF]/.test(e))t.style.direction="rtl";else{if(!/[a-zA-Z]/.test(e))return"نامشخص";t.style.direction="ltr"}};let firstinput=document?.querySelector("textarea.chatNodata"),chaticons=document.querySelectorAll(".SendMessage");const opacityIcon=e=>{let t=e;t.addEventListener("keypress",(function(e){chaticons.forEach((e=>{e.style.opacity=".5"}))})),t.addEventListener("keyup",(function(e){chaticons.forEach((e=>{e.style.opacity="1"}))}))};firstinput&&opacityIcon(firstinput);const sendMessageOne=()=>{let e=document.querySelector("textarea.chatNodata"),t=document.querySelector("div.sec1"),o=document.querySelector("div.sec2");detectLanguage(e.value),scrollToBottom(),""!=e.value?(t.classList.add("hideChat"),o.classList.add("showChat"),sendMessage(e.value)):AlertMessage("Error","لطفا فیلد را پر کنید")},chatvalue=document?.querySelector("#chat2");function sendMessage(e){if(e){detectLanguage(e);const t=document.createElement("div");t.setAttribute("class","ME w-full flex gap-6 justify-start items-start"),t.innerHTML=`\n        <span class="userIcon w-[30px] h-[30px] flex justify-center items-center rounded-full bg-primary">\n        <img src="http://cdn.basiscore.net/nljpdiw.undertest.ir/images/usericon-v3.svg" alt="basis" title="basis" class="w-[16px] h-[16px] object-contain">\n        </span> \n        <span class="userDetail w-auto flex flex-col justify-start items-start">\n        <div class="userName w-auto flex justify-start font-IRANSansWeb500 font-medium text-xs\n        leading-[22px] text-text">\n        شما\n        </div>\n        <div class=" w-auto flex justify-start font-IRANSansWeb400 font-normal text-[10px]\n        leading-[15.65px] text-sm">\n        ${e}\n    \n        </div>\n        </span>\n        `,document.querySelector("#chatbox").appendChild(t),$bc.setSource("db.send",{run:!0,val:e}),e="",document.querySelector("#current_section")?.removeAttribute("id")}else{let e=document.querySelector("#chat2");detectLanguage(e.value);const t=document.createElement("div");t.setAttribute("class","ME w-full flex gap-6 justify-start items-start"),t.innerHTML=`\n        <span class="userIcon w-[30px] h-[30px] flex justify-center items-center rounded-full bg-primary">\n        <img src="http://cdn.basiscore.net/nljpdiw.undertest.ir/images/usericon-v3.svg" alt="basis" title="basis" class="w-[16px] h-[16px] object-contain">\n        </span> \n        <span class="userDetail w-auto flex flex-col justify-start items-start">\n        <div class="userName w-auto flex justify-start font-IRANSansWeb500 font-medium text-xs\n        leading-[22px] text-text">\n        شما\n        </div>\n        <div class=" w-auto flex justify-start font-IRANSansWeb400 font-normal text-[10px]\n        leading-[15.65px] text-sm">\n        ${e.value}\n    \n        </div>\n        </span>\n        `,document.querySelector("#chatbox").appendChild(t),$bc.setSource("db.send",{run:!0,val:e.value}),e.value="",document.querySelector("#current_section")?.removeAttribute("id")}scrollToBottom()}opacityIcon(chatvalue);let chatinput=document?.querySelector("#chat");chatinput?.addEventListener("keydown",(function(e){let t=document.querySelector("_textarea.chatNodata"),o=document.querySelector("div.sec1"),n=document.querySelector("div.sec2");13==e.keyCode&&(e.preventDefault(),""!=t.value&&(o.classList.add("hideChat"),n.classList.add("showChat"),sendMessage(t.value),chatinput.value=""))}));let chatinput2=document.querySelector("#chat2");function opcytext(e,t){CopyToClipboard(e.closest(".userDetail").querySelector(".current_section"))}function CopyToClipboard(e){if(document.selection)(t=document.body.createTextRange()).moveToElementText(e),t.select().createTextRange(),document.execCommand("copy");else if(window.getSelection){var t;(t=document.createRange()).selectNode(e),window.getSelection().addRange(t),document.execCommand("copy"),AlertMessage("Success","متن در clipboard کپی شد.")}}function selectItem(e,t){if(scrollToBottom(),dropPop.classList.remove("OpenDrop"),firstinput?.classList.contains("hideChat"))document.querySelector("#chat2").value=e.getAttribute("data-val");else{let t=document?.querySelector("div.sec1"),o=document.querySelector("div.sec2");t?.classList.add("hideChat"),o.classList.add("showChat"),document.querySelector("#chat2").value=e.getAttribute("data-val"),sendMessage(e.getAttribute("data-val"))}}chatinput2.addEventListener("keydown",(function(e){13==e.keyCode&&(e.preventDefault(),""!=chatinput2.value&&(sendMessage(chatinput2.value),chatinput2.value=""))}));