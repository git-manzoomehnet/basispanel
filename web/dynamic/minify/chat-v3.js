let userMessage=document.querySelectorAll(".YOU");function copyToClipboard(e){const t=e;navigator.clipboard.writeText(t).then((()=>console.log("copy text"))).catch((e=>console.error("error in copy:",e)))}userMessage.forEach((e=>{let t=e.querySelector(".message").innerHTML;e.querySelector(".CopyText").addEventListener("click",(()=>{console.log(t,"message"),copyToClipboard(t)}))}));let langIcon=document.querySelector(".langC"),langSVG=document.querySelector(".langC svg"),langContent=document.querySelector(".langs-content");if(langIcon.addEventListener("click",(e=>{if(e.stopPropagation(),langContent.classList.toggle("openLang"),langSVG.classList.toggle("rotate"),document.querySelector(".UserProfile-box .User ")){let e=document.querySelector(".UserProfile-box .UserDropdown"),t=document.querySelector(".UserProfile-box .Icon ");e.classList.remove("openProf"),t.classList.remove("openProf")}})),document.querySelector(".UserProfile-box .User ")){let e=document.querySelector(".UserProfile-box .Icon "),t=document.querySelector(".UserProfile-box .UserDropdown"),o=document.querySelector(".logoOut ");document.querySelector(".UserProfile-box .User").addEventListener("click",(o=>{o.stopPropagation(),t.classList.toggle("openProf"),e.classList.toggle("openProf"),langContent.classList.remove("openLang"),langSVG.classList.remove("rotate")})),o.addEventListener("click",(e=>{e.stopPropagation(),console.log("logoOut"),$bc.setSource("query.flag",!0),$bc.setSource("db.logout",!0),langContent.classList.remove("openLang"),langSVG.classList.remove("rotate")}))}let drops=document.querySelectorAll(".DropDowns .Drop");if(drops.forEach((e=>{let t=e.querySelector(".dropdown-menu"),o=e.querySelector(".title-dropdown"),n=e.querySelector(".icon");t&&t.querySelector("ul li")?o.addEventListener("click",(o=>{e.classList.toggle("open"),e.classList.contains("open")?(t.style.height=t.scrollHeight+"px",t.style.opacity="1"):(t.style.height="0px",t.style.opacity="0")})):n&&(n.style.display="none")})),document.addEventListener("click",(e=>{if(console.log("click"),langContent.classList.remove("openLang"),langSVG.classList.remove("rotate"),document.querySelector(".UserProfile-box .User ")){let e=document.querySelector(".UserProfile-box .UserDropdown"),t=document.querySelector(".UserProfile-box .Icon ");e.classList.remove("openProf"),t.classList.remove("openProf")}})),document.querySelector(".Popup-container")){let n=document.querySelector(".Popup-container"),s=document.querySelector(".login-button"),c=document.querySelector(".Popup-container .ClosePop"),r=document.querySelector(".Popup-container");n.addEventListener("click",(e=>{e.target==r&&(e.stopPropagation(),console.log("click outside pop"),n.classList.toggle("open"))}));function refreshAndFetch(){let e="http://nljpdiw.undertest.ir/dmntoken-v3.inc?nocache="+(new Date).getTime();fetch(e).then((e=>e.text())).then((e=>{let t=(new DOMParser).parseFromString(e,"text/html").querySelector(".dmntoken").textContent;console.log(t,"tokenValue"),$bc.setSource("db.token",t)})).catch((e=>console.error("خطا در دریافت مقدار:",e)))}s.addEventListener("click",(e=>{$bc.setSource("get.dmntoken",!0),n.classList.toggle("open"),refreshAndFetch(),$bc.setSource("run.token",!0)})),c.addEventListener("click",(e=>{console.log("close pop"),n.classList.toggle("open"),$bc.setSource("run.api",!0),$bc.setSource("get.dmntoken",!1)}))}const lenis=new Lenis({smoothWheel:!0,wheelMultiplier:2});function raf(e){lenis.raf(e),requestAnimationFrame(raf)}async function loadingchat(){document.querySelector("#chat");const e=document.createElement("div");e.setAttribute("class","YOU w-full flex gap-6 justify-start items-start"),e.innerHTML='\n   \n                <span class="userIcon w-[30px] h-[30px] flex justify-center items-center rounded-full">\n                    <img src="/images/user1-v3.png" alt="basis" title="basis" class="object-contain">\n                </span> \n                <div class="userDetail w-95p mr-auto grid grid-cols-[5fr,1fr] justify-start items-start " id="typewriter">\n                    <div class="  w-full flex justify-start font-IRANSansWeb400 font-normal text-[10px]\n                    leading-[30px] text-sm  current_section" id="current_section">\n                    <div class="loader"></div>\n                    </div>\n                    <div class="contact-c w-full flex justify-end items-center gap-2">\n                        <span class="CopyText hover:cursor-pointer" onclick="opcytext(this,event)">\n                            <img src="/images/copy-v3.svg" alt="basis" title="basis">\n                        </span>\n                        <span class="disLike hover:cursor-pointer">\n                            <img src="/images/dislike-v3.svg" alt="basis" title="basis">\n                        </span>\n                        <span class="like hover:cursor-pointer">\n                            <img src="/images/like-v3.svg" alt="basis" title="basis">\n                        </span>\n                    </div>\n                </div>\n            \n    ',document.querySelector("#chatbox").appendChild(e)}async function setChatFirst(e){const t=e.response,o=(await t.json()).message;for(var n=0;n<o.length;n++)typeText(o,n)}function typeText(e,t){setTimeout((()=>{document.querySelector("#current_section").textContent+=e.charAt(t)}),50*t)}requestAnimationFrame(raf),lenis.on("scroll",(e=>{0==e.scroll?document.querySelector("header").classList.remove("bgWhite"):document.querySelector("header").classList.add("bgWhite")}));const detectLanguage=e=>{let t=document.querySelector("#chatbox");if(/[\u0600-\u06FF]/.test(e))console.log("فارسی"),t.style.direction="rtl";else{if(!/[a-zA-Z]/.test(e))return console.log("نامشخص"),"نامشخص";t.style.direction="ltr",console.log("انگلیسی")}};let firstinput=document?.querySelector("input.chatNodata"),chaticons=document.querySelectorAll(".SendMessage");const opacityIcon=e=>{let t=e;t.addEventListener("keypress",(function(e){chaticons.forEach((e=>{e.style.opacity=".5"}))})),t.addEventListener("keyup",(function(e){chaticons.forEach((e=>{e.style.opacity="1"}))}))};opacityIcon(firstinput);const sendMessageOne=()=>{let e=document.querySelector("input.chatNodata"),t=document.querySelector("div.sec1"),o=document.querySelector("div.sec2");detectLanguage(e.value),""!=e.value?(console.log("send"),t.classList.add("hideChat"),o.classList.add("showChat"),sendMessage(e.value)):AlertMessage("Error","لطفا فیلد را پر کنید")},chatvalue=document?.querySelector("#chat2");function sendMessage(e){if(e){detectLanguage(e);const t=document.createElement("div");t.setAttribute("class","ME w-full flex gap-6 justify-start items-start"),t.innerHTML=`\n        <span class="userIcon w-[30px] h-[30px] flex justify-center items-center rounded-full bg-primary">\n        <img src="http://cdn.basiscore.net/nljpdiw.undertest.ir/images/usericon-v3.svg" alt="basis" title="basis" class="w-[16px] h-[16px] object-contain">\n        </span> \n        <span class="userDetail w-auto flex flex-col justify-start items-start">\n        <div class="userName w-auto flex justify-start font-IRANSansWeb500 font-medium text-xs\n        leading-[22px] text-text">\n        شما\n        </div>\n        <div class=" w-auto flex justify-start font-IRANSansWeb400 font-normal text-[10px]\n        leading-[15.65px] text-sm">\n        ${e}\n    \n        </div>\n        </span>\n        `,document.querySelector("#chatbox").appendChild(t),$bc.setSource("db.send",{run:!0,val:e}),e="",document.querySelector("#current_section")?.removeAttribute("id")}else{let e=document.querySelector("#chat2");detectLanguage(e.value);const t=document.createElement("div");t.setAttribute("class","ME w-full flex gap-6 justify-start items-start"),t.innerHTML=`\n        <span class="userIcon w-[30px] h-[30px] flex justify-center items-center rounded-full bg-primary">\n        <img src="http://cdn.basiscore.net/nljpdiw.undertest.ir/images/usericon-v3.svg" alt="basis" title="basis" class="w-[16px] h-[16px] object-contain">\n        </span> \n        <span class="userDetail w-auto flex flex-col justify-start items-start">\n        <div class="userName w-auto flex justify-start font-IRANSansWeb500 font-medium text-xs\n        leading-[22px] text-text">\n        شما\n        </div>\n        <div class=" w-auto flex justify-start font-IRANSansWeb400 font-normal text-[10px]\n        leading-[15.65px] text-sm">\n        ${e.value}\n    \n        </div>\n        </span>\n        `,document.querySelector("#chatbox").appendChild(t),$bc.setSource("db.send",{run:!0,val:e.value}),e.value="",document.querySelector("#current_section")?.removeAttribute("id")}}opacityIcon(chatvalue);var wage=document.getElementById("chat2");wage.addEventListener("keydown",(function(e){13==e.keyCode&&sendMessage()}));let chatinput=document?.querySelector("#chat");function opcytext(e,t){CopyToClipboard(e.closest(".userDetail").querySelector(".current_section"))}function CopyToClipboard(e){if(document.selection)(t=document.body.createTextRange()).moveToElementText(e),t.select().createTextRange(),document.execCommand("copy");else if(window.getSelection){var t;(t=document.createRange()).selectNode(e),window.getSelection().addRange(t),document.execCommand("copy"),AlertMessage("Success","متن در clipboard کپی شد.")}}function selectItem(e,t){if(firstinput?.classList.contains("hideChat"))document.querySelector("#chat2").value=e.getAttribute("data-val");else{let t=document?.querySelector("div.sec1"),o=document.querySelector("div.sec2");console.log("send"),t?.classList.add("hideChat"),o.classList.add("showChat"),document.querySelector("#chat2").value=e.getAttribute("data-val"),sendMessage(e.getAttribute("data-val"))}}chatinput?.addEventListener("keydown",(function(e){let t=document.querySelector("input.chatNodata"),o=document.querySelector("div.sec1"),n=document.querySelector("div.sec2");13==e.keyCode&&""!=t.value&&(console.log("send"),o.classList.add("hideChat"),n.classList.add("showChat"),sendMessage(t.value))}));